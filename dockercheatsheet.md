# Docker & Docker-Compose Cheat Sheet

## Docker Commands

### 1. **Image Management**
- **Build an image from Dockerfile**:
  ```sh
  docker build [options] -t <tag_name> <path_to_dockerfile>
  ```
  - `-t` : Name and optionally tag an image (e.g., `-t myapp:latest`).
  - `-f` : Specify Dockerfile name and path.

- **List all images**:
  ```sh
  docker images
  ```

- **Pull an image from Docker Hub**:
  ```sh
  docker pull <image>
  ```

- **Remove an image**:
  ```sh
  docker rmi <image_name_or_id>
  ```
  - `-f` : Force remove an image.

### 2. **Container Management**
- **Run a container**:
  ```sh
  docker run [options] <image>
  ```
  - `-d` : Run container in detached mode.
  - `-p` : Publish a containerâ€™s port to the host (e.g., `-p 8080:80`).
  - `-e` : Set environment variables (e.g., `-e MY_VAR=value`).
  - `--name` : Assign a name to the container (e.g., `--name my_container`).
  - `--rm` : Automatically remove the container when it exits.
  - `-v` : Bind mount a volume (e.g., `-v /host/path:/container/path`).

- **List all running containers**:
  ```sh
  docker ps
  ```
  - `-a` : Show all containers, including stopped ones.

- **Stop a container**:
  ```sh
  docker stop <container_name_or_id>
  ```

- **Start a container**:
  ```sh
  docker start <container_name_or_id>
  ```

- **Remove a container**:
  ```sh
  docker rm <container_name_or_id>
  ```
  - `-f` : Force remove a running container.

- **Access a running container**:
  ```sh
  docker exec -it <container_name_or_id> /bin/bash
  ```
  - `-it` : Run in interactive mode with a TTY.

- **Attach to a container**:
  ```sh
  docker attach <container_name_or_id>
  ```

- **Container logs**:
  ```sh
  docker logs <container_name_or_id>
  ```
  - `-f` : Follow the log output.
  - `--tail <n>` : Show the last `<n>` lines of logs.

### 3. **Volume Management**
- **List volumes**:
  ```sh
  docker volume ls
  ```

- **Create a volume**:
  ```sh
  docker volume create <volume_name>
  ```

- **Remove a volume**:
  ```sh
  docker volume rm <volume_name>
  ```

- **Inspect a volume**:
  ```sh
  docker volume inspect <volume_name>
  ```

### 4. **Network Management**
- **List networks**:
  ```sh
  docker network ls
  ```

- **Create a network**:
  ```sh
  docker network create <network_name>
  ```

- **Connect a container to a network**:
  ```sh
  docker network connect <network_name> <container_name>
  ```

- **Disconnect a container from a network**:
  ```sh
  docker network disconnect <network_name> <container_name>
  ```

- **Remove a network**:
  ```sh
  docker network rm <network_name>
  ```

### 5. **Docker Compose**

#### Basic Commands
- **Start services**:
  ```sh
  docker-compose up
  ```
  - `-d` : Run containers in detached mode.
  - `--build` : Build images before starting containers.

- **Stop services**:
  ```sh
  docker-compose down
  ```
  - `-v` : Remove named volumes declared in the `volumes` section of the Compose file.
  - `--rmi all` : Remove all images used by any service.

- **Restart services**:
  ```sh
  docker-compose restart
  ```

- **List running services**:
  ```sh
  docker-compose ps
  ```

- **Show logs**:
  ```sh
  docker-compose logs
  ```
  - `-f` : Follow log output.
  - `--tail <n>` : Show the last `<n>` lines of logs.

#### Advanced Usage
- **Scale services**:
  ```sh
  docker-compose up --scale <service_name>=<number>
  ```
  Example:
  ```sh
  docker-compose up --scale web=3
  ```

- **Run a one-off command in a service container**:
  ```sh
  docker-compose run <service_name> <command>
  ```
  - Example: `docker-compose run web /bin/bash`
  - `--rm` : Automatically remove the container after it exits.

- **Build or rebuild services**:
  ```sh
  docker-compose build
  ```
  - `--no-cache` : Do not use cache when building the image.

### Docker Compose File Structure (Key Sections)
- **services**: Define the different services that make up your application.
  ```yaml
  services:
    web:
      image: nginx
      ports:
        - "8080:80"
  ```

- **volumes**: Persist data generated by and used by Docker containers.
  ```yaml
  volumes:
    db_data:
  ```

- **networks**: Define custom networks to connect services.
  ```yaml
  networks:
    backend:
  ```

- **depends_on**: Specify dependencies between services.
  ```yaml
  services:
    wordpress:
      depends_on:
        - db
  ```

### Docker-Compose Flags Summary
- **`-d`**: Run in detached mode.
- **`--build`**: Build images before starting containers.
- **`--scale`**: Scale a service to the specified number of instances.
- **`-f <file>`**: Specify the compose file to use (e.g., `docker-compose -f docker-compose.prod.yml up`).
- **`-p <project_name>`**: Set the project name.
- **`--remove-orphans`**: Remove containers for services not defined in the Compose file.

